--riva_module("Snd/Jack", {file("Jack.o")})
--riva_module("Snd/FluidSynth", {file("FluidSynth.o")})
riva_module("Snd/SndFile", {file("SndFile.o")})
--riva_module("Snd/Lilv", {file("Lilv.o")})

CFLAGS = extend(CFLAGS, "-I", file("/usr/local/include/sphinxbase"), "-I", file("/usr/local/include/pocketsphinx"))
riva_module("Snd/PocketSphinx", {file("PocketSphinx.o")})


SMC_VERSION = "0.1.9"
SMC_DIR = file("libsamplerate-" .. SMC_VERSION)

SMC_DIR:build(function()
	execute("wget -nv http://www.mega-nerd.com/SRC/libsamplerate-" .. SMC_VERSION .. ".tar.gz -O- | tar xvzP")
end)

file("libsamplerate.a"){SMC_DIR}:build(function()
	execute{"cd", SMC_DIR, "&&",
		"./configure --disable-shared --enable-static",
		"--prefix=" .. file(""),
		"--libdir=" .. file(""),
		"CFLAGS=\"" .. stringify(CFLAGS) .. " -O2\"",
		"CXXFLAGS=\"" .. stringify(CXXFLAGS) .. " -O2\""
	}
	execute{"cd", SMC_DIR, "&&", "make TARGET_LIBS=\"static\""}
	execute{"cd", SMC_DIR, "&&", "make install"}
end)

CFLAGS = extend(CFLAGS, "-I", file("include"))

file("SampleRate.o"){file("libsamplerate.a")}
riva_module("Snd/SampleRate", {file("SampleRate.o")})
